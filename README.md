# Tetris_cmd

## 程序简介

以C++编写的使用命令行界面模拟俄罗斯方块的程序。

目前只完成了基础操作部分，目前代码量约900+行，预计完成项目代码量约1300+行。（双人对战模式令加700+行）

## 运行要求

首次使用时Windows 8 / 10需将CMD的“使用旧版控制台”打开，“快速插入”和“快速编辑模式”关闭。运行CMD窗口时关闭输入法。

## 操作介绍

开始界面使用方向上下或W和S键操作光标。

### 单人模式键位：

- A：左移
- D：右移
- S：下降
- W：硬降
- Q：左转
- E：右转

## 已完成内容：

### 单人模式下的：

- 新方块刷新
- 方块的自动下落
- 左移、右移、左转、右转操作
- 下降、硬降操作（下落+移动同时操作时可能有BUG）
- 下落方块检测并刷新新方块
- 整行填满消除的判断
- 最顶行的Game over判断（可能有BUG）
- 操作延迟优化
- 分数计算
- 强制刷新（F8）（对付卡方块BUG的终极解决方法，不过貌似改了下操作代码之后卡方块BUG不会再出现了）

## 待完成内容：

### 单人模式下的：

- 即将出现的后N个方块的缓存区
- HOLD
- 屏幕刷新闪屏双缓存优化
- 天梯榜

### 多人模式下的：

- 双人同时操作的基本功能实现
- 对战分数计算
- 消除行的对方惩罚
- 天梯榜

### 其他

- 键位自定义
- 游戏区域大小自定义

## Something else

- 由于基础代码设计缺陷，目前Game over的判断为顶部两行有放置的方块即为游戏结束。
- 分数计算规则：每次消除n行加(1+2+...+n)分。
- 出现卡方块解决方法：按键盘F8强制刷新（正常情况下请勿使用）
- 作者本人最高分数：176

## 整体思路

声明两个bool型二维数组block和src，分别用于储存已固定方块和屏幕缓存，使用查表的方式将当前方块叠加到已固定的方块上并储存进屏幕缓存（占了大部分代码量），最后遍历缓存区输出到屏幕。

键盘操作方面先判断是否操作是否有效（是否与已有方块重合或超过边缘），再刷新方块的坐标。